<%- include("./fragments/head") %>

<body class="body body-ingresos-del-mes">

  <%- include("./fragments/navbar") %>

  <h3>Ingresos del mes</h3>

  <% if (month) { %>
  <input type="hidden" value=<%= month %> id="month-hidden" />
  <% } %>

  <select class="form-select ingresosMonthSelector" aria-label="Selector de mes" name="monthSelector">
    <option value="0" class="month ene">Enero</option>
    <option value="1" class="month feb">Febrero</option>
    <option value="2" class="month mar">Marzo</option>
    <option value="3" class="month abr">Abril</option>
    <option value="4" class="month may">Mayo</option>
    <option value="5" class="month jun">Junio</option>
    <option value="6" class="month jul">Julio</option>
    <option value="7" class="month ago">Agosto</option>
    <option value="8" class="month sep">Septiembre</option>
    <option value="9" class="month oct">Octubre</option>
    <option value="10" class="month nov">Noviembre</option>
    <option value="11" class="month dic">Diciembre</option>
  </select>

  <div class="container-gral-table">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th>Día</th>
          <th>Concepto</th>
          <th>Monto</th>
          <th>Obs</th>
        </tr>
      </thead>
      <tbody>
        <% if (ingresos.length === 0) { %>
        <tr>
          <td colspan="5">No se registran ingresos en este período</td>
        </tr>
        <% } else { %>
        <% for( let i = 0; i < ingresos.length; i++ ) { %>
        <tr>
          <td scope="col"><%= i + 1 %></td>
          <td><%= ingresos[i].date %></td>
          <td><%= ingresos[i].concept %></td>
          <td>$ <%= ingresos[i].value %></td>
          <% if (ingresos[i].obs === "") { %>
          <td>-</th>
            <% } else {%>
          <td><%= ingresos[i].obs %></td>
          <% } %>
        </tr>
        <% } %>
        <% } %>
      </tbody>
    </table>
  </div>

    <% let totalIngresos = []; %>
    <% ingresos.forEach(monto => { %>
    <% totalIngresos = [...totalIngresos, monto.value]%>
    <% }) %>
    <% let resultado = totalIngresos.reduce((prev, curr) => prev + curr, 0 )%>

    <p>Total de ingresos: $ <span><%= resultado %></span></p>

  <%- include("./fragments/scripts") %>
</body>

</html>